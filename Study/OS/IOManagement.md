## Device Controllers

Драйверы устройств - программные модули, которые можно подключить к ОС для работы с конкретным устройством. ОС использует драйверы устройств для обработки всех устройств ввода-вывода.

Контроллер устройств работает как интерфейс между устройством и драйвером устройства. Блоки ввода-вывода обычно состоят из механического компонента и электронного компонента, где электронный компонент называется контроллером устройства.

Контроллер устройства может иметь возможность обрабатывать несколько устройств. В качестве интерфейса его основной задачей является преобразование последовательного битового потока в блок байтов, при необходимости исправление ошибок.

## Communication to I/O Devices

Для связи с ЦП и устройством доступны три подхода:

- Специальный инструкции ввода/вывода
- Ввод/вывод с отображением памяти
- Прямой доступ к памяти (DMA)

### Special Instruction I/O

При этом подходе используются инструкции ЦП, специально предназначенные для управления устройствами ввода/вывода. Эти инструкции обычно позволяют отправлять данные на устройство ввода-вывода или считывать их с устройства ввода-вывода.

### Memory-mapped I/O

При использовании ввода-вывода с отображением памяти одно и то же адресное пространство используется совместно с памятью и устройствами ввода-вывода. Устройство подключается непосредственно к определенным ячейкам основной памяти, чтобы устройство ввода/вывода могло передавать блок данных в/из памяти, минуя ЦП.

![[memmory-mapped-io]]

При использовании ввода-вывода с отображением памяти ОС выделяет буфер в памяти и сообщает устройству ввода-вывода использовать этот буфер для отправки данных в ЦП. Устройство ввода-вывода работает асинхронно с ЦП, прерывает ЦП по завершении.

Преимущество этого метода состоит в том, что каждая инструкция, имеющая доступ к памяти, может использоваться для управления устройством ввода/вывода.

### Direct memory access (DMA)

Прямой доступ к памяти означает, что ЦП предоставляет модулю ввода-вывода полномочия на чтение или запись в память без участия. Модуль DMA сам управляет обменом данными между основной памятью и устройством ввода/вывода. Цп задействован только в начале и в конце передачи и прерывается только после передачи всего блока.

Для прямого доступа к памяти требуется контроллер DMA (DMAC), который управляет передачей данных и разрешает доступ к системной шине. Контроллеры запрограммированы указателями источника и назначения (где читать/записывать данные), счетчиками для отслеживания количества переданных байтов и настройками, которые включают типы ввода-вывода и памяти, прерывания и состояния для циклов ЦП.
